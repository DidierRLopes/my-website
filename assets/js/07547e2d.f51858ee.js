"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[3258],{27780:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>d,frontMatter:()=>a,metadata:()=>o,toc:()=>c});var n=i(85893),s=i(3905);const a={slug:"time-series-crossvalidation-for-nn",title:"Time-Series CrossValidation for NN",date:new Date("2021-09-04T00:00:00.000Z"),image:"/blog/2021-09-04-time-series-crossvalidation-for-nn.png",tags:["Python","Data Science","Deep Learning","Time Series","Cross Validation","Neural Networks"],description:"This blog post discusses the creation of a Python module for splitting univariate time-series data using cross-validation techniques. The module is designed to prepare data for training, validation, and testing in a Deep Neural Network (DNN)."},r=void 0,o={permalink:"/blog/time-series-crossvalidation-for-nn",editUrl:"https://github.com/DidierRLopes/my-website/tree/main/blog/2021-09-04-time-series-crossvalidation-for-nn.md",source:"@site/blog/2021-09-04-time-series-crossvalidation-for-nn.md",title:"Time-Series CrossValidation for NN",description:"This blog post discusses the creation of a Python module for splitting univariate time-series data using cross-validation techniques. The module is designed to prepare data for training, validation, and testing in a Deep Neural Network (DNN).",date:"2021-09-04T00:00:00.000Z",tags:[{inline:!0,label:"Python",permalink:"/blog/tags/python"},{inline:!0,label:"Data Science",permalink:"/blog/tags/data-science"},{inline:!0,label:"Deep Learning",permalink:"/blog/tags/deep-learning"},{inline:!0,label:"Time Series",permalink:"/blog/tags/time-series"},{inline:!0,label:"Cross Validation",permalink:"/blog/tags/cross-validation"},{inline:!0,label:"Neural Networks",permalink:"/blog/tags/neural-networks"}],readingTime:2.66,hasTruncateMarker:!0,authors:[],frontMatter:{slug:"time-series-crossvalidation-for-nn",title:"Time-Series CrossValidation for NN",date:"2021-09-04T00:00:00.000Z",image:"/blog/2021-09-04-time-series-crossvalidation-for-nn.png",tags:["Python","Data Science","Deep Learning","Time Series","Cross Validation","Neural Networks"],description:"This blog post discusses the creation of a Python module for splitting univariate time-series data using cross-validation techniques. The module is designed to prepare data for training, validation, and testing in a Deep Neural Network (DNN)."},unlisted:!1,prevItem:{title:"Gamestonk Terminal \u2014 Can\u2019t Stop, Won\u2019t Stop",permalink:"/blog/gamestonk-terminal-cant-stop-won-t-stop"},nextItem:{title:"Ranking 99 Mind f*ck movies",permalink:"/blog/ranking-99-mind-f-ck-movies"}},l={authorsImageUrls:[]},c=[{value:"Split Train",id:"split-train",level:2},{value:"Split Train Val",id:"split-train-val",level:2},{value:"Split Train Val Test",id:"split-train-val-test",level:2}];function p(e){const t={a:"a",code:"code",em:"em",h2:"h2",img:"img",p:"p",pre:"pre",strong:"strong",...(0,s.ah)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{align:"center",children:(0,n.jsx)("img",{width:"600",src:"/blog/2021-09-04-time-series-crossvalidation-for-nn.png"})}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsx)(t.p,{children:"This blog post discusses the creation of a Python module for splitting univariate time-series data using cross-validation techniques. The module is designed to prepare data for training, validation, and testing in a Deep Neural Network (DNN)."}),"\n",(0,n.jsxs)(t.p,{children:["The open source code is available ",(0,n.jsx)(t.a,{href:"https://github.com/DidierRLopes/timeseries-cv",children:"here"}),"."]}),"\n",(0,n.jsx)("div",{style:{borderTop:"1px solid #0088CC",margin:"1.5em 0"}}),"\n",(0,n.jsxs)(t.p,{children:["2 years ago, ",(0,n.jsx)(t.a,{href:"https://www.linkedin.com/in/ACoAACK9n24BrpxWf0HMa9bL7MSHleu2YVXpI5E",children:"Filipe Ramos"})," my previous maths and probability teacher, knowing that I had a special interest in Data Science, challenged me to help him in his PhD thesis \u201c",(0,n.jsx)(t.em,{children:"Data Science na Modela\xe7\xe3o e Previs\xe3o de S\xe9ries Econ\xf3mico-financeiras: das Metodologias Cl\xe1ssicas ao Deep Learning"}),"\u201d."]}),"\n",(0,n.jsx)(t.p,{children:"Although we have been discussing theory, analysis and results, my main contribution was to write the Python code behind the thesis."}),"\n",(0,n.jsx)(t.p,{children:"As a result, I have written a python module that splits a given univariate time-series based on cross-validation techniques so that these can be fed to a Deep Neural Network (DNN) to extract training/validation/test errors."}),"\n",(0,n.jsx)(t.p,{children:"I know that there are examples of these online, but this was made from scratch so that we could personalise it according to the thesis\u2019 needs, and grasp better what was at stake when performing different cross-validation techniques."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.strong,{children:"The idea is given a training dataset, the package will split it into Train, Validation and Test sets, by means of either Forward Chaining, K-Fold or Group K-Fold."})}),"\n",(0,n.jsxs)(t.p,{children:["As parameters the user can not only select the number of inputs (",(0,n.jsx)(t.code,{children:"n_steps_input"}),") and outputs (",(0,n.jsx)(t.code,{children:"n_steps_forecast"}),"), but also the number of samples (",(0,n.jsx)(t.code,{children:"n_steps_jump"}),") to jump in the data to train."]}),"\n",(0,n.jsxs)(t.p,{children:["The best way to install the package is as follows: ",(0,n.jsx)(t.code,{children:"pip install timeseries-cv"})," and then use it with ",(0,n.jsx)(t.code,{children:"import tsxv"}),". See the module developed ",(0,n.jsx)(t.a,{href:"https://pypi.org/project/timeseries-cv/",children:"here"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:["This can be seen more intuitively using the jupyter notebook: \u201c",(0,n.jsx)(t.em,{children:"example.ipynb"}),"\u201d Below you can find an example of the usage of each function for the following Time-Series:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-python",children:"timeSeries = array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26])\n"})}),"\n",(0,n.jsx)(t.h2,{id:"split-train",children:"Split Train"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-python",children:"from tsxv.splitTrain import \nsplit_train, \nsplit_train_variableInput\nX, y = split_train(timeSeries, n_steps_input=4, n_steps_forecast=3, n_steps_jump=2)\nX, y = split_train_variableInput(timeSeries, minSamplesTrain=10, n_steps_forecast=3, n_steps_jump=3)\n"})}),"\n",(0,n.jsxs)("div",{className:"flex justify-center gap-2",children:[(0,n.jsx)("img",{src:"/blog/2021-09-04-time-series-crossvalidation-for-nn_1.png",width:"50%"}),(0,n.jsx)("img",{src:"/blog/2021-09-04-time-series-crossvalidation-for-nn_2.png",width:"50%"})]}),"\n",(0,n.jsx)(t.h2,{id:"split-train-val",children:"Split Train Val"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-python",children:"from tsxv.splitTrainVal import \nsplit_train_val_forwardChaining, \nsplit_train_val_kFold, \nsplit_train_val_groupKFold\nX, y, Xcv, ycv = split_train_val_forwardChaining(timeSeries, n_steps_input=4, n_steps_forecast=3, n_steps_jump=2)\nX, y, Xcv, ycv = split_train_val_kFold(timeSeries, n_steps_input=4, n_steps_forecast=3, n_steps_jump=2)\nX, y, Xcv, ycv = split_train_val_groupKFold(timeSeries, n_steps_input=4, n_steps_forecast=3, n_steps_jump=2)\n"})}),"\n",(0,n.jsxs)("div",{className:"flex justify-center gap-2",children:[(0,n.jsx)("img",{src:"/blog/2021-09-04-time-series-crossvalidation-for-nn_3.png",width:"50%"}),(0,n.jsx)("img",{src:"/blog/2021-09-04-time-series-crossvalidation-for-nn_4.png",width:"50%"})]}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"image",src:i(63957).Z+"",width:"1400",height:"913"})}),"\n",(0,n.jsx)(t.h2,{id:"split-train-val-test",children:"Split Train Val Test"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-python",children:"from tsxv.splitTrainValTest import split_train_val_test_forwardChaining, \nsplit_train_val_test_kFold,\nsplit_train_val_test_groupKFold\nX, y, Xcv, ycv, Xtest, ytest = split_train_val_test_forwardChaining(timeSeries, n_steps_input=4, n_steps_forecast=3, n_steps_jump=2)\nX, y, Xcv, ycv, Xtest, ytest = split_train_val_test_kFold(timeSeries, n_steps_input=4, n_steps_forecast=3, n_steps_jump=2)\nX, y, Xcv, ycv, Xtest, ytest = split_train_val_test_groupKFold(timeSeries, n_steps_input=4, n_steps_forecast=3, n_steps_jump=2)\n"})}),"\n",(0,n.jsxs)("div",{className:"flex justify-center gap-2",children:[(0,n.jsx)("img",{src:"/blog/2021-09-04-time-series-crossvalidation-for-nn_6.png",width:"50%"}),(0,n.jsx)("img",{src:"/blog/2021-09-04-time-series-crossvalidation-for-nn_7.png",width:"50%"})]}),"\n",(0,n.jsx)("br",{}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"image",src:i(30432).Z+"",width:"1400",height:"913"})}),"\n",(0,n.jsxs)(t.p,{children:["This module has not only been used for my friends\u2019 thesis but also for a Data Science company and ",(0,n.jsx)(t.a,{href:"/blog/gamestonk-terminal-the-next-best-thing-after-bloomberg-terminal",children:"Gamestonk Terminal"}),", that I know of :)"]}),"\n",(0,n.jsxs)(t.p,{children:["You can check the stats of the module ",(0,n.jsx)(t.a,{href:"https://pypistats.org/packages/timeseries-cv",children:"here"}),"."]})]})}function d(e={}){const{wrapper:t}={...(0,s.ah)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(p,{...e})}):p(e)}},3905:(e,t,i)=>{i.d(t,{ah:()=>c});var n=i(67294);function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function a(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function r(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?a(Object(i),!0).forEach((function(t){s(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function o(e,t){if(null==e)return{};var i,n,s=function(e,t){if(null==e)return{};var i,n,s={},a=Object.keys(e);for(n=0;n<a.length;n++)i=a[n],t.indexOf(i)>=0||(s[i]=e[i]);return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)i=a[n],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(s[i]=e[i])}return s}var l=n.createContext({}),c=function(e){var t=n.useContext(l),i=t;return e&&(i="function"==typeof e?e(t):r(r({},t),e)),i},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var i=e.components,s=e.mdxType,a=e.originalType,l=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),h=c(i),m=s,g=h["".concat(l,".").concat(m)]||h[m]||p[m]||a;return i?n.createElement(g,r(r({ref:t},d),{},{components:i})):n.createElement(g,r({ref:t},d))}));d.displayName="MDXCreateElement"},63957:(e,t,i)=>{i.d(t,{Z:()=>n});const n=i.p+"assets/images/2021-09-04-time-series-crossvalidation-for-nn_5-b1fcd9ac1d3769b8c0fd4d35137e026e.png"},30432:(e,t,i)=>{i.d(t,{Z:()=>n});const n=i.p+"assets/images/2021-09-04-time-series-crossvalidation-for-nn_8-5a2ee102a5d0e988a6aaf3dadc079741.png"}}]);