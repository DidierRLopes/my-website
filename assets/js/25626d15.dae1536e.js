"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[80268],{53190:(e,t,n)=>{n.r(t),n.d(t,{default:()=>_});var o=n(96540),r=n(13317),s=n(78478),i=n(95293),a=n(40961),l=n(74848);const d=({url:e,title:t,thumbnail:n,isLarge:r=!1})=>{const[s,i]=(0,o.useState)(!1),[d,c]=(0,o.useState)({top:0,left:0}),m=(0,o.useRef)(null),p={position:"absolute",right:"20px",top:r?"-42px":"-22px",width:r?"120px":"60px",height:r?"120px":"60px",transition:"width 0.3s ease, height 0.3s ease, top 0.3s ease"},h={visibility:s?"visible":"hidden",position:"fixed",top:`${d.top}px`,left:`${d.left}px`,transform:"translate(-50%, -100%)",width:"200px",backgroundColor:"black",color:"#fff",textAlign:"center",borderRadius:"6px",padding:"5px 0",zIndex:1e3,opacity:s?1:0,transition:"opacity 0.3s",pointerEvents:"none"},u={content:'""',position:"absolute",top:"100%",left:"50%",marginLeft:"-5px",borderWidth:"5px",borderStyle:"solid",borderColor:"black transparent transparent transparent"},x=()=>(0,a.createPortal)((0,l.jsxs)("div",{style:h,children:[t,(0,l.jsx)("div",{style:u})]}),document.body);return(0,l.jsxs)("div",{style:p,children:[(0,l.jsx)("a",{ref:m,href:e,target:"_blank",rel:"noopener noreferrer",onMouseEnter:()=>{if(m.current){const e=m.current.getBoundingClientRect();c({top:e.top-10,left:e.left+e.width/2})}i(!0)},onMouseLeave:()=>i(!1),children:(0,l.jsx)("img",{src:n,alt:t,style:{width:"100%",height:"100%",borderRadius:"4px",objectFit:"cover",border:"1px solid #ccc"}})}),s&&(0,l.jsx)(x,{})]})},c=({size:e=40,style:t={}})=>(0,l.jsx)("img",{src:"/img/rickandmorty_portal_gun.webp",alt:"Portal Gun",style:{width:e,height:"auto",...t},title:"Clear terminal"}),m=({color:e="currentColor",size:t=20})=>(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 24 24",stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,l.jsx)("title",{children:"Clear terminal"}),(0,l.jsx)("path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21H7Z",fill:"hotpink"}),(0,l.jsx)("path",{d:"M22 21H7"}),(0,l.jsx)("path",{d:"m5 12 5 5"})]}),p=({history:e,onSendMessage:t,isLoading:n,aiTextColor:r,onClearHistory:s,isClearing:a,hasBeenCleared:p})=>{const{colorMode:h}=(0,i.G)(),u="dark"===h,x={position:"relative",overflow:"hidden",color:u?"white":"black",fontFamily:"monospace",padding:"20px",height:"500px",width:"100%",borderRadius:"5px",boxShadow:"0 0 12px 4px "+(u?"rgba(255, 255, 0, 0.5)":"rgba(0, 0, 255, 0.3)"),transition:"box-shadow 0.3s ease-in-out"},g=u?"url(/img/terminal_bg_dark.png)":"url(/img/terminal_bg_light.png)",y={marginRight:"10px",color:u?"white":"black"},f={backgroundColor:"transparent",border:"none",color:u?"white":"black",fontFamily:"monospace",fontSize:"1em",width:"100%",outline:"none"},[b,j]=o.useState(""),w=o.useRef(null),v=o.useRef(null),[k,C]=o.useState(!1);o.useEffect(()=>{if(u&&a){C(!0);const e=setTimeout(()=>C(!1),1300);return()=>clearTimeout(e)}},[a,u]);o.useEffect(()=>{w.current&&w.current.scrollTo({top:w.current.scrollHeight,behavior:"smooth"})},[e.length]),o.useEffect(()=>{n||v.current?.focus({preventScroll:!0})},[n]);const S=e=>{const t={whiteSpace:"pre-wrap",maxWidth:"70%",wordWrap:"break-word"};switch(e){case"user":default:return{...t,color:u?"white":"black"};case"ai":return{...t,color:r};case"error":return{...t,color:"#ff0000"}}},I=u?"rgba(255, 255, 255, 0.5)":"#6c757d";return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("style",{children:`\n                    #terminal-container::before {\n                        content: '';\n                        position: absolute;\n                        top: 0; left: 0; right: 0; bottom: 0;\n                        background-image: ${g};\n                        background-size: cover;\n                        background-position: bottom;\n                        background-repeat: no-repeat;\n                        filter: blur(2px);\n                        z-index: 0;\n                    }\n                    #terminal-input::placeholder {\n                        color: ${I};\n                        opacity: 1; /* Firefox */\n                    }\n                    @keyframes wipe-zigzag-vertical {\n                        0%   { transform: translate(50px, -50px) rotate(60deg); opacity: 1; }\n                        12.5% { transform: translate(250px, 25px) rotate(-60deg); }\n                        25%  { transform: translate(50px, 100px) rotate(60deg); }\n                        37.5% { transform: translate(250px, 175px) rotate(-60deg); }\n                        50%  { transform: translate(50px, 250px) rotate(60deg); }\n                        62.5% { transform: translate(250px, 325px) rotate(-60deg); }\n                        75%  { transform: translate(50px, 400px) rotate(60deg); }\n                        87.5% { transform: translate(250px, 475px) rotate(-60deg); }\n                        100% { transform: translate(150px, 550px) rotate(60deg); opacity: 0; }\n                    }\n\n                    .wiping-eraser {\n                        position: absolute;\n                        top: 0;\n                        left: 0;\n                        z-index: 10;\n                        animation: wipe-zigzag-vertical 1.5s ease-in-out forwards;\n                        color: ${u?"white":"black"};\n                    }\n\n                    /* Rick and Morty Dark Mode Animations */\n                    @keyframes shoot-portal-gun {\n                        0% { transform: translateX(100px) rotate(-30deg); opacity: 0; }\n                        25% { transform: translateX(0) rotate(-45deg); opacity: 1; }\n                        75% { transform: translateX(0) rotate(-45deg); opacity: 1; }\n                        100% { transform: translateX(100px) rotate(-30deg); opacity: 0; }\n                    }\n\n                    @keyframes portal-effect {\n                        0% { transform: translate(-50%, -50%) scale(0) rotate(0deg); opacity: 0; }\n                        30% { transform: translate(-50%, -50%) scale(1) rotate(360deg); opacity: 1; }\n                        80% { transform: translate(-50%, -50%) scale(1) rotate(720deg); opacity: 1; }\n                        100% { transform: translate(-50%, -50%) scale(0) rotate(1080deg); opacity: 0; }\n                    }\n                    \n                    .portal-gun-animation {\n                        position: absolute;\n                        bottom: 20px;\n                        right: 20px;\n                        z-index: 10;\n                        animation: shoot-portal-gun 1.5s ease-in-out forwards;\n                    }\n\n                    .portal-animation {\n                        position: absolute;\n                        top: 50%;\n                        left: calc(50% - 180px);\n                        z-index: 9;\n                        animation: portal-effect 1.3s ease-in-out; /* Delay start slightly */\n                    }\n                    \n                    .portal-animation img {\n                        width: 250px;\n                        height: 250px;\n                    }\n                `}),(0,l.jsxs)("div",{id:"terminal-container",style:x,children:[0===e.length&&p&&!a&&(0,l.jsx)("div",{style:{position:"absolute",top:"5px",left:"5px",right:"5px",bottom:"5px",borderRadius:"5px",boxShadow:u?"inset 0 0 15px rgba(255, 255, 255, 0.1)":"inset 0 0 15px rgba(0, 0, 0, 0.1)",pointerEvents:"none"}}),a&&(u?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"portal-gun-animation",children:(0,l.jsx)(c,{size:80})}),k&&(0,l.jsx)("div",{className:"portal-animation",children:(0,l.jsx)("img",{src:"/img/rickandmorty_portal.webp",alt:"Rick and Morty Portal"})})]}):(0,l.jsx)("div",{className:"wiping-eraser",children:(0,l.jsx)(m,{size:40})})),(0,l.jsx)("button",{type:"button",onClick:s,disabled:a,style:{position:"absolute",bottom:"15px",right:"15px",background:"none",border:"none",cursor:"pointer",zIndex:5,opacity:0!==e.length||a?1:.5,display:"flex",alignItems:"center",justifyContent:"center",padding:"5px",color:u?"white":"black",visibility:a?"hidden":"visible"},title:"Clear terminal",children:u?!a&&(0,l.jsx)(c,{size:30,style:{transform:"rotate(-45deg)"}}):!a&&(0,l.jsx)(m,{})}),(0,l.jsxs)("div",{style:{position:"relative",zIndex:1,height:"100%",overflowY:"auto",paddingBottom:"30px",opacity:a&&u?0:1,transition:"opacity 0.3s ease-out 0.7s"},ref:w,children:[e.map((e,t)=>{const n=`${e.sender}-${e.text.slice(0,20)}-${t}`;if("ai"===e.sender){const t=e.text.split("\n").length>=3;return(0,l.jsxs)("div",{style:{position:"relative",marginBottom:"1em"},children:[(0,l.jsx)("div",{style:S(e.sender),children:e.text}),e.source&&(0,l.jsx)(d,{...e.source,isLarge:t})]},n)}return(0,l.jsx)("div",{style:S(e.sender),children:"user"===e.sender?`> ${e.text}`:e.text},n)}),!n&&(0,l.jsxs)("div",{style:{display:"flex"},children:[(0,l.jsx)("span",{style:y,children:">"}),(0,l.jsx)("input",{ref:v,id:"terminal-input",type:"text",style:f,value:b,onChange:e=>{j(e.target.value)},onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),b.trim()&&!n&&(t(b),j("")))},placeholder:"Type your message...",disabled:n,autoComplete:"off"})]})]})]})]})};var h=n(21122);const u=({size:e=13,color:t="currentColor"})=>(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:t,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{display:"inline-block"},children:[(0,l.jsx)("title",{children:"External link"}),(0,l.jsx)("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),(0,l.jsx)("polyline",{points:"15 3 21 3 21 9"}),(0,l.jsx)("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]}),x=({children:e})=>(0,l.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",padding:"2rem"},children:e}),g=({color:e})=>{const[t,n]=o.useState(""),[r,s]=o.useState("\ud83c\udf0e");return o.useEffect(()=>{const e=async()=>{try{const e=await fetch("https://api.weather.gov/points/40.71,-74.01");if(!e.ok)throw new Error("Failed to fetch weather points");const t=(await e.json()).properties.forecastHourly,n=await fetch(t);if(!n.ok)throw new Error("Failed to fetch hourly forecast");const o=(await n.json()).properties.periods[0];o.isDaytime?s((e=>{const t=e.toLowerCase();return t.includes("thunderstorm")?"\u26c8\ufe0f":t.includes("rain")||t.includes("shower")?"\ud83c\udf27\ufe0f":t.includes("snow")?"\u2744\ufe0f":t.includes("cloudy")?"\u2601\ufe0f":t.includes("partly cloudy")||t.includes("mostly cloudy")?"\u26c5\ufe0f":t.includes("sunny")||t.includes("clear")?"\u2600\ufe0f":t.includes("haze")||t.includes("fog")?"\ud83c\udf2b\ufe0f":"\ud83c\udf0e"})(o.shortForecast)):s("\ud83c\udf19")}catch(e){console.error("Failed to fetch NYC weather:",e)}};e();const t=setInterval(e,9e5);return()=>clearInterval(t)},[]),o.useEffect(()=>{const e=setInterval(()=>{const e=new Date,t={timeZone:"America/New_York"},o=new Intl.DateTimeFormat("en",{year:"numeric",...t}).format(e),r=new Intl.DateTimeFormat("en",{month:"2-digit",...t}).format(e),s=new Intl.DateTimeFormat("en",{day:"2-digit",...t}).format(e),i=new Intl.DateTimeFormat("en",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1,...t}).format(e),a=e.getMilliseconds().toString().padStart(3,"0");n(`${s}/${r}/${o} ${i}:${a}`)},50);return()=>clearInterval(e)},[]),(0,l.jsxs)("div",{style:{position:"absolute",top:"-25px",right:"0px",fontSize:"0.9em",color:e},children:["NYC ",r,", ",t]})},y=({status:e})=>{const t="online"===e?"#28a745":"offline"===e?"#dc3545":"#6c757d";return(0,l.jsx)("span",{style:{height:"10px",width:"10px",backgroundColor:t,borderRadius:"50%",display:"inline-block",marginRight:"8px",transition:"background-color 0.5s ease"},title:`Ollama status: ${e}`})},f=({title:e,progress:t,isDark:n})=>{const o=n?"white":"black",r=n?"#4A4A4A":"#E0E0E0";return(0,l.jsxs)("div",{style:{position:"relative",width:"100%",height:"28px",border:"1px solid "+(n?"#555":"#CCC"),borderRadius:"5px",backgroundColor:"transparent",marginTop:"1rem",overflow:"hidden"},children:[(0,l.jsx)("div",{style:{width:`${t}%`,height:"100%",backgroundColor:r,transition:"width 0.15s ease-in-out"}}),(0,l.jsx)("span",{style:{position:"absolute",top:"50%",left:"10px",transform:"translateY(-50%)",color:o,whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",maxWidth:"calc(100% - 20px)"},children:e||"Starting..."})]})},b=({onClick:e,disabled:t,children:n,style:r={}})=>{const{colorMode:s}=(0,i.G)(),a="dark"===s,[d,c]=o.useState(!1),m={padding:"2px 12px",backgroundColor:t?a?"#333":"#EAEAEA":a?d?"#555":"#444":d?"#DCDCDC":"#EAEAEA",color:t?a?"#777":"#AAA":a?"#EEE":"#333",border:"1px solid "+(t?a?"#444":"#DDD":a?"#666":"#CCC"),borderRadius:"5px",cursor:t?"not-allowed":"pointer",transition:"background-color 0.2s, color 0.2s, border-color 0.2s",...r};return(0,l.jsx)("button",{type:"button",onClick:e,disabled:t,style:m,onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),children:n})};function j(e,t){const n=e.reduce((e,n,o)=>e+n*t[o],0),o=Math.sqrt(e.reduce((e,t)=>e+t*t,0)),r=Math.sqrt(t.reduce((e,t)=>e+t*t,0));return 0===o||0===r?0:n/(o*r)}function w(e){return(new DOMParser).parseFromString(e,"text/html").body.textContent||""}const v="You are an AI assistant representing Didier Lopes. Founder, builder, and product thinker at the intersection of open source, AI and finance. Communicate with clarity, edge, and purpose. Prioritize actionable insight, strong opinions, and clean design. Avoid fluff. Speak to devs, investors, and power users. Think like a strategist, write like a builder, execute like a founder. Write in lower case only. Try to answer concisely, ideally in a tweet-sized response. Your task is to answer questions as if you were him, based *exclusively* on the content of his blog posts provided as context. If the provided context does not contain the answer to a question, you must state that you haven't written about that topic yet, rather than attempting to answer from your general knowledge.",k=({command:e})=>{const{colorMode:t}=(0,i.G)(),n={color:"dark"===t?"#82dffc":"#005cc5",fontWeight:"bold",fontSize:"0.85em",whiteSpace:"pre-wrap",wordBreak:"break-all"};return(0,l.jsx)("div",{style:{display:"flex",alignItems:"center",marginTop:"0.5rem",fontFamily:'Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace'},children:(0,l.jsxs)("code",{style:n,children:["$ ",e]})})},C=({indexing:e,indexingResult:t})=>(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("img",{src:"/img/goku_waiting_for_embeds.webp",alt:"Goku waiting for embeddings",style:{position:"absolute",bottom:"calc(100% - 15px)",left:"10px",height:"130px",opacity:e||t?0:1,transition:"opacity 0.5s ease-in-out",pointerEvents:"none",zIndex:1}}),(0,l.jsx)("div",{className:"thought-bubble",style:{bottom:"calc(100% + 75px)",left:"110px",opacity:e||t?0:1},children:"where my embeddings at?"}),(0,l.jsx)("img",{src:"/img/goku_indexing_embeddings.webp",alt:"Goku indexing",style:{position:"absolute",bottom:"calc(100% - 15px)",left:"10px",height:"130px",opacity:e?1:0,transition:"opacity 0.5s ease-in-out",pointerEvents:"none",zIndex:1}}),(0,l.jsx)("div",{className:"thought-bubble thought-bubble--indexing",style:{bottom:"calc(100% + 75px)",left:"110px",opacity:e?1:0},children:"SOMETHING IS HAPPENING!"}),(0,l.jsx)("img",{src:"/img/goku_has_embeddings.webp",alt:"Goku has embeddings",style:{position:"absolute",bottom:"calc(100% - 15px)",left:"10px",height:"130px",opacity:!e&&t?1:0,transition:"opacity 0.5s ease-in-out",pointerEvents:"none",zIndex:1}}),(0,l.jsx)("div",{className:"thought-bubble",style:{bottom:"calc(100% + 75px)",left:"110px",opacity:!e&&t?1:0},children:"i'm smort now"})]}),S=()=>{const{colorMode:e}=(0,i.G)(),t="dark"===e,n={border:"2px solid "+(t?"#444":"#CCC"),borderRadius:"8px",padding:"1.5rem",margin:"0.5rem",flex:1,textAlign:"left",backgroundColor:t?"#1C1C1C":"#F9F9F9",display:"flex",flexDirection:"column",justifyContent:"space-between"},r={color:t?"white":"inherit"},[s,a]=o.useState(()=>{if("undefined"!=typeof navigator){const e=navigator.platform?.toLowerCase()||"",t=navigator.userAgent?.toLowerCase()||"";if(e.includes("mac")||t.includes("mac"))return"mac";if(e.includes("win")||t.includes("win"))return"windows";if(e.includes("linux")||t.includes("linux"))return"linux"}return"mac"}),d=e=>({padding:"0.25rem 0.5rem",border:"none",borderBottom:"2px solid "+(s===e?t?"#93c5fd":"#1e40af":"transparent"),backgroundColor:"transparent",color:t?"#EEE":"#333",cursor:"pointer",fontSize:"0.9em",fontWeight:s===e?"bold":"normal",transition:"border-color 0.2s"});return(0,l.jsxs)("div",{style:{width:"80%",marginTop:"4rem"},children:[(0,l.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",marginBottom:"2rem",gap:"1rem"},children:[(0,l.jsx)("img",{src:"/img/ollama.svg",alt:"Ollama Logo",style:{height:"50px",filter:t?"invert(1)":"none"}}),(0,l.jsx)("h2",{children:"Get Started with Ollama"})]}),(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"stretch",gap:"1rem"},children:[(0,l.jsxs)("div",{style:n,children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{style:{marginBottom:"1rem"},children:(0,l.jsx)("h3",{style:r,children:"Step 1: Install Ollama"})}),(0,l.jsx)("p",{style:{marginBottom:"1rem"},children:"Download Ollama so you can run models (and embeddings) locally (and securely)."})]}),(0,l.jsxs)("a",{href:"https://ollama.com/",target:"_blank",rel:"noopener noreferrer",style:{textDecoration:"underline",color:t?"#93c5fd":"#1e40af",display:"inline-flex",alignItems:"center",gap:"4px"},children:["Go to ollama.com",(0,l.jsx)(u,{})]})]}),(0,l.jsxs)("div",{style:n,children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{style:{marginBottom:"1rem"},children:(0,l.jsx)("h3",{style:r,children:"Step 2: Chat Model"})}),(0,l.jsx)("p",{style:{marginBottom:"1rem"},children:"Open your terminal and run this command to get the chat model of your choice."})]}),(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,l.jsx)("p",{style:{margin:0,display:"flex",alignItems:"center",height:"100%"},children:"e.g."}),(0,l.jsx)(k,{command:"ollama pull llama3.2:3b"})]})]}),(0,l.jsxs)("div",{style:n,children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{style:{marginBottom:"1rem"},children:(0,l.jsx)("h3",{style:r,children:"Step 3: Embedding Model"})}),(0,l.jsx)("p",{style:{marginBottom:"1rem"},children:"For the AI to access my posts as context, we need an embedding model."})]}),(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,l.jsx)("p",{style:{margin:0,display:"flex",alignItems:"center",height:"100%"},children:"e.g."}),(0,l.jsx)(k,{command:"ollama pull nomic-embed-text"})]})]})]}),(0,l.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"stretch",gap:"1rem",marginTop:"1rem"},children:(0,l.jsxs)("div",{style:{...n,justifyContent:"flex-start"},children:[(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[(0,l.jsx)("h3",{style:r,children:"Step 4: Enable CORS"}),(0,l.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[(0,l.jsx)("button",{type:"button",onClick:()=>a("mac"),style:d("mac"),children:"macOS"}),(0,l.jsx)("button",{type:"button",onClick:()=>a("windows"),style:d("windows"),children:"Windows"}),(0,l.jsx)("button",{type:"button",onClick:()=>a("linux"),style:d("linux"),children:"Linux"})]})]}),(0,l.jsxs)("p",{style:{marginTop:"1rem",marginBottom:"1rem"},children:["By default, browsers block web pages from calling local servers for security reasons. ",(0,l.jsx)("br",{}),"You must explicitly tell Ollama to allow requests from"," ",(0,l.jsx)("strong",{style:{display:"inline-flex",alignItems:"center",gap:"4px"},children:"https://didierlopes.com"}),"."]}),(()=>{switch(s){case"mac":return(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{style:{margin:"0.5rem 0"},children:"Run in Terminal then restart Ollama:"}),(0,l.jsx)(k,{command:'launchctl setenv OLLAMA_ORIGINS "https://didierlopes.com"'})]});case"windows":return(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{style:{margin:"0.5rem 0"},children:"Run in PowerShell (Admin) then restart Ollama:"}),(0,l.jsx)(k,{command:'setx OLLAMA_ORIGINS "https://didierlopes.com" /m'})]});case"linux":return(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{style:{margin:"0.5rem 0"},children:"Add this to your systemd unit, then restart the service:"}),(0,l.jsx)(k,{command:"sudo systemctl edit ollama.service"}),(0,l.jsxs)("pre",{style:{background:t?"#111":"#EEE",padding:"0.5rem",borderRadius:"4px",marginTop:"0.5rem",fontSize:"0.85em"},children:["[Service]",(0,l.jsx)("br",{}),'Environment="OLLAMA_ORIGINS=https://didierlopes.com"']}),(0,l.jsx)(k,{command:"sudo systemctl restart ollama"})]})}})()]})}),(0,l.jsxs)("p",{style:{textAlign:"center",margin:"1.5rem 0.5rem 0 0.5rem",fontSize:"0.9em",color:t?"#AAA":"#555"},children:["Run the Ollama app in the background, if it was running kill it first so the CORS settings take effect.",(0,l.jsx)("br",{}),"By default, it uses ",(0,l.jsx)("a",{href:"http://localhost:11434/",target:"_blank",rel:"noopener noreferrer",style:{color:t?"#93c5fd":"#1e40af",textDecoration:"underline"},children:"http://localhost:11434/"}),". Check the URL to confirm you get an ",(0,l.jsx)("strong",{children:'"Ollama is running"'})," message."]})]})},I=({isOpen:e,onClose:t,sources:n,alt:o})=>{const{colorMode:r}=(0,i.G)(),s="dark"===r;return e?(0,l.jsx)("div",{onClick:t,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||t()},role:"button",tabIndex:0,style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.75)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,backdropFilter:"blur(5px)"},children:(0,l.jsxs)("div",{onClick:e=>e.stopPropagation(),onKeyDown:e=>e.stopPropagation(),role:"presentation",style:{position:"relative",maxWidth:"90vw",maxHeight:"90vh"},children:[(0,l.jsx)("button",{onClick:t,type:"button",style:{position:"absolute",top:"20px",right:"20px",background:"none",border:"none",color:s?"white":"black",fontSize:"24px",cursor:"pointer",padding:0,lineHeight:"24px",height:"24px",width:"24px",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001,transition:"transform 0.2s ease-in-out"},onMouseEnter:e=>{e.currentTarget.style.transform="scale(1.2)"},onMouseLeave:e=>{e.currentTarget.style.transform="scale(1)"},children:"\u2715"}),(0,l.jsx)(h.A,{alt:o,sources:n,style:{maxWidth:"100%",maxHeight:"90vh",objectFit:"contain",border:"1px solid "+(s?"#444":"#CCC"),borderRadius:"8px"}})]})}):null},A=()=>{const e=o.useRef(null),[t,n]=o.useState(!1),[r,s]=o.useState(1);return(0,l.jsxs)("div",{style:{width:"80%",marginTop:"4rem",textAlign:"center"},children:[(0,l.jsx)("h2",{children:"How It Works"}),(0,l.jsxs)("p",{style:{margin:"1rem auto",maxWidth:"100ch"},children:["This is your typical RAG setup. ",(0,l.jsx)("br",{}),(0,l.jsx)("br",{}),"When you ask a question, it's converted into an embedding and compared against a vector store of chunks from my blog posts. The most relevant chunks (in this embedding space) are injected as context (as text) for the AI to answer your question."]}),(0,l.jsx)("div",{onClick:()=>n(!0),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||n(!0)},role:"button",tabIndex:0,style:{cursor:"pointer"},children:(0,l.jsx)(h.A,{alt:"Sequence diagram showing the RAG process",sources:{light:"/img/lifeline_sequence_diagram_light.png",dark:"/img/lifeline_sequence_diagram_dark.png"},style:{width:"80%",marginTop:"1rem",border:"1px solid #444",borderRadius:"8px",transform:`scale(${r})`,transition:"transform 0.2s ease-in-out"}})}),(0,l.jsx)(I,{isOpen:t,onClose:()=>n(!1),sources:{light:"/img/lifeline_sequence_diagram_light.png",dark:"/img/lifeline_sequence_diagram_dark.png"},alt:"Sequence diagram showing the RAG process"}),(0,l.jsx)("p",{style:{margin:"1rem auto",maxWidth:"100ch"},children:"If this is still confusing, I created a small podcast on notebookLM that explains what is going on."}),(0,l.jsx)("div",{style:{display:"flex",justifyContent:"center",width:"100%"},children:(0,l.jsxs)("audio",{ref:e,controls:!0,style:{width:"50%"},children:[(0,l.jsx)("source",{src:"/audio/ollama_notebooklm.wav",type:"audio/wav"}),(0,l.jsx)("track",{kind:"captions"})]})})]})},E=()=>{const{colorMode:e}=(0,i.G)(),t="dark"===e,n=t?"#FFFF00":"blue",[r,s]=o.useState("http://localhost:11434"),[a,d]=o.useState("http://localhost:11434"),[c,m]=o.useState("llama3.1:8b"),[h,u]=o.useState([]),[k,I]=o.useState(""),[E,_]=o.useState([]),[T,O]=o.useState([]),[F,R]=o.useState(!1),[L,$]=o.useState(!1),[z,D]=o.useState(!1),[M,N]=o.useState("pending"),[B,G]=o.useState(!1),[W,q]=o.useState(0),[P,H]=o.useState(""),[Y,J]=o.useState([]),[K,U]=o.useState(null);(0,o.useEffect)(()=>{const e=localStorage.getItem("ollamaUrl");e&&(s(e),d(e));const t=localStorage.getItem("blogVectorStore");k&&(()=>{if(t){const{model:e,vectors:n,timestamp:o}=JSON.parse(t);e===k&&(J(n),U({count:n.length,timestamp:new Date(o)}))}})()},[k]),(0,o.useEffect)(()=>{const e=setTimeout(()=>{a!==r&&(s(a),localStorage.setItem("ollamaUrl",a))},500);return()=>clearTimeout(e)},[a,r]),(0,o.useEffect)(()=>{(async()=>{N("pending");try{const e=await fetch(`${r}/api/tags`);if(!e.ok)throw new Error("Server not responding");const t=(await e.json()).models.map(e=>e.name),n=t.filter(e=>!e.includes("embed"));u(n),n.length>0&&!c&&m(n[0]);const o=t.filter(e=>e.includes("embed"));_(o),o.length>0&&I(o[0]),N("online")}catch(e){console.error("Failed to fetch Ollama models:",e),N("offline"),u([]),_([])}})()},[r,c]);return(0,l.jsxs)(x,{children:[(0,l.jsxs)("div",{style:{marginBottom:"2rem",width:"60%"},children:[(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{htmlFor:"ollama-url",children:[(0,l.jsx)(y,{status:M}),"Ollama URL:"]}),(0,l.jsx)("input",{id:"ollama-url",type:"text",value:a,onChange:e=>{d(e.target.value)},style:{width:"250px",marginLeft:"8px"}})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"ollama-model",children:"Model: "}),(0,l.jsx)("select",{id:"ollama-model",value:c,onChange:e=>m(e.target.value),style:{width:"250px",marginLeft:"8px"},disabled:"online"!==M||0===h.length||B,children:h.map(e=>(0,l.jsx)("option",{value:e,children:e},e))})]})]}),(0,l.jsxs)("div",{style:{marginTop:"1rem",display:"flex",flexDirection:"column",alignItems:"stretch"},children:[(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end"},children:[(0,l.jsx)("label",{htmlFor:"ollama-embedding-model",children:"Embeddings: "}),(0,l.jsx)("select",{id:"ollama-embedding-model",value:k,onChange:e=>I(e.target.value),style:{width:"250px",marginLeft:"8px"},disabled:"online"!==M||0===E.length||B,children:E.map(e=>(0,l.jsx)("option",{value:e,children:e},e))})]}),(0,l.jsxs)("div",{style:{marginTop:"1rem",display:"flex",alignItems:"center",justifyContent:"flex-end"},children:[(0,l.jsx)(b,{onClick:async()=>{if(k){G(!0),q(0),H(""),J([]),U(null);try{const t=await fetch("https://didierlopes.com/blog/feed.json");if(!t.ok)throw new Error("Failed to fetch blog feed");const n=(await t.json()).items,o=[];for(let i=0;i<n.length;i++){const t=n[i];H(t.title);try{const e=w(t.content_html),n=t.content_html.match(/<img.*?src=\"(.*?)\"/),s=n?n[1]:"",i=await fetch(`${r}/api/embeddings`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:k,prompt:e})});if(!i.ok)throw new Error(`Embedding failed for "${t.title}"`);const{embedding:a}=await i.json();o.push({title:t.title,content:e,embedding:a,url:t.url,thumbnail:s})}catch(e){console.error(`Error processing post "${t.title}":`,e),O(n=>[...n,{text:`Error on "${t.title}": ${e.message}\n\n`,sender:"error"}])}q((i+1)/n.length*100)}J(o);const s={count:o.length,timestamp:new Date};U(s),localStorage.setItem("blogVectorStore",JSON.stringify({model:k,vectors:o,timestamp:s.timestamp}))}catch(t){console.error(t),O(e=>[...e,{text:`Failed to index blog: ${t.message}\n\n`,sender:"error"}])}finally{G(!1),H("")}}else alert("Please select an embedding model first.")},disabled:B||"online"!==M,style:{visibility:B?"hidden":"visible"},children:"Index my blog"}),B?(0,l.jsx)("div",{style:{width:"50%",marginLeft:"1rem"},children:(0,l.jsx)(f,{title:P,progress:W,isDark:t})}):K&&(0,l.jsxs)("span",{style:{fontSize:"0.8em",color:t?"#AAA":"#555",marginLeft:"1rem"},children:[K.count," posts indexed at ",K.timestamp?.toLocaleTimeString()]})]})]})]}),(0,l.jsxs)("div",{style:{position:"relative",width:"60%",marginTop:"4rem"},children:[(0,l.jsx)(C,{indexing:B,indexingResult:!!K}),(0,l.jsx)(g,{color:n}),(0,l.jsx)(p,{history:T,onSendMessage:async e=>{R(!0);const t=[...T,{text:e,sender:"user"}];O(t);let n=e,o=v,s=null;if(Y.length>0&&k)try{const t=await fetch(`${r}/api/embeddings`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:k,prompt:e})});if(!t.ok)throw new Error("Failed to embed user query.");const{embedding:i}=await t.json();let a=null;for(const e of Y){const t=j(i,e.embedding);(!a||t>a.score)&&(a={...e,score:t})}s=a,console.log("Best match found:",s),s&&s.score>.6&&s.url&&(n=`Based on the following context, please answer the user's question.\n\nContext:\n---\n${s.content}\n---\n\nQuestion:\n${e}`,o=`${v} ${"When you answer a question that has used context from one of the indexed blog posts, you should add a [source](blog_url) link at the end of your answer.".replace("blog_url",s.url)}`)}catch(a){console.error("Error during RAG:",a),O(e=>[...e,{text:`Could not retrieve context: ${a.message}`,sender:"error"}])}const i=[{role:"system",content:o},...T.filter(e=>"user"===e.sender||"ai"===e.sender).map(e=>({role:"ai"===e.sender?"assistant":"user",content:e.text.trim()})),{role:"user",content:n}];try{const e=await fetch(`${r}/api/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:c,messages:i,stream:!0})}),t=404===e.status?await fetch(`${r}/api/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:c,system:o,prompt:n,stream:!0})}):e;if(!t.body)throw new Error("No response body");O(e=>[...e,{text:"",sender:"ai"}]);const a=t.body.getReader(),l=new TextDecoder;let d;for(;;){const{done:e,value:t}=await a.read();if(e){O(e=>{if(e.length>0&&"ai"===e[e.length-1].sender){const t=e[e.length-1],n=!t.text.toLowerCase().includes("haven't written about that topic yet");s&&s.score>.6&&s.url&&s.title&&s.thumbnail&&n&&(d={url:s.url,title:s.title,thumbnail:s.thumbnail}),console.log("Final source for message:",d);let o=t.text.replace(/\[source\]\([^\)]+\)/gi,"").trim();o.endsWith("\n")&&(o=o.replace(/\n+$/,""));const r={...t,text:`${o}\n\n`,source:d};return[...e.slice(0,-1),r]}return e});break}const n=l.decode(t,{stream:!0}).split("\n").filter(e=>""!==e.trim());for(const o of n){let e;try{e=JSON.parse(o)}catch{e={response:o}}const t=e?.message?.content??e?.response??"";t&&O(e=>{const n=e[e.length-1],o={...n,text:n.text+t};return[...e.slice(0,-1),o]})}}}catch(l){console.error(l),O(e=>[...e,{text:`Error: ${l.message}\n\n`,sender:"error"}])}finally{R(!1)}},isLoading:F,aiTextColor:n,onClearHistory:()=>{$(!0),D(!0),setTimeout(()=>{O([]),$(!1)},1500)},isClearing:L,hasBeenCleared:z})]}),(0,l.jsx)("div",{style:{width:"60%",marginTop:"2rem",textAlign:"center",color:t?"#AAA":"#555",fontSize:"0.9em"},children:(0,l.jsxs)("p",{children:["This page allows you to chat with a local AI model running on your machine using Ollama.",(0,l.jsx)("br",{}),"Please ensure Ollama is running and you have a model (and embeddings) available."]})}),(0,l.jsx)(S,{}),(0,l.jsx)(A,{})]})},_=()=>(0,l.jsx)(r.A,{title:"Chat",children:(0,l.jsxs)("main",{style:{padding:"2rem"},children:[(0,l.jsx)("div",{style:{textAlign:"center"},children:(0,l.jsx)("h1",{children:"Chat"})}),(0,l.jsx)("div",{className:"intelligence-page-desktop",children:(0,l.jsx)(s.A,{children:()=>(0,l.jsx)(E,{})})}),(0,l.jsx)("div",{className:"intelligence-page-mobile",children:(0,l.jsxs)("div",{style:{textAlign:"center",padding:"2rem",position:"relative"},children:[(0,l.jsx)(h.A,{alt:"Chat with AI on Desktop",sources:{light:"/img/chat_terminal_mobile_light.png",dark:"/img/chat_terminal_mobile_dark.png"},style:{width:"100%",filter:"blur(2px)"}}),(0,l.jsx)("div",{className:"intelligence-bubble",children:"Chat with my AI on Desktop"})]})})]})})},78478:(e,t,n)=>{n.d(t,{A:()=>s});n(96540);var o=n(92303),r=n(74848);function s({children:e,fallback:t}){return(0,o.A)()?(0,r.jsx)(r.Fragment,{children:e?.()}):t??null}}}]);